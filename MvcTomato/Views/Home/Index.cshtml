@using MvcTomato.Helpers
@using MvcTomato.ViewModels
@model WorkingDayViewModel
@{
    ViewBag.Title = "Home Page";
}

<div>
  <div>
    @Html.ValidationSummary()
  </div>
  @if (ViewBag.Uncompleted != null)
  {
      List<WorkingDayViewModel> uncompleted = ViewBag.Uncompleted;
    <div>
      <p>You have the following uncompleted records:</p>
      <table class="table table-sm">
        <tr>
          <th>Enter</th>
          <th>Dinner - Start</th>
          <th>Dinner - Finish</th>
          <th>Exit</th>
          <th>Actions</th>
        </tr>
          @foreach (var entry in uncompleted)
          {
              <tr>
                  <td>@string.Format("{0:hh\\:mm}", entry.Enter)</td>
                  <td>@string.Format("{0:hh\\:mm}", entry.DinnerStart)</td>
                  <td>@string.Format("{0:hh\\:mm}", entry.DinnerFinish)</td>
                  <td>@string.Format("{0:hh\\:mm}", entry.Exit)</td>
                  <td>@Html.ActionLink("Continue edit", "Edit", new { id = entry.Id })</td>
              </tr>
          }
      </table>
    </div>
  }
  <div>
    <form method="post">
        <div>
            @Html.HiddenFor(m => m.Date, new { data_date = DateTime.Today.ToString("yyyy-MM-dd") })
            <div class="input-group">
                @Html.LabelFor(m => m.Date, "Date")
                @Html.TextBox("UserDate", String.Empty, new { id = "datepicker", @class = "form-control", autocomplete = "off" })
            </div>
            <div class="input-group">
                @Html.LabelFor(m => m.Enter, "Enter")
                @Html.TextBoxFor(m => m.Enter, "{0:hh\\:mm}", new { @class = "form-control", placeholder = "0:00" })
            </div>
            <div class="input-group">
                @Html.LabelFor(m => m.DinnerStart, "Dinner start")
                @Html.TextBoxFor(m => m.DinnerStart, "{0:hh\\:mm}", new { @class = "form-control", placeholder = "0:00" })
            </div>
            <div class="input-group">
                @Html.LabelFor(m => m.DinnerFinish, "Dinner finish")
                @Html.TextBoxFor(m => m.DinnerFinish, "{0:hh\\:mm}", new { @class = "form-control", placeholder = "0:00" })
            </div>
            <div class="input-group">
                @Html.LabelFor(m => m.Exit, "Exit")
                @Html.TextBoxFor(m => m.Exit, "{0:hh\\:mm}", new { @class = "form-control", placeholder = "0:00" })
            </div>
        </div>
      <br/>
      <input class="btn btn-default" type="submit" value="Submit"/>
    </form>
  </div>
  <div>
      <h3>Month statistics</h3>
      @{
          if (ViewBag.MonthStatistics != null)
          {
              TimeSpan monthAllSum = ViewBag.MonthAllSum;
              foreach (TimeSpan day in ViewBag.MonthStatistics)
              {
                  <span class="@(day < TimeSpan.Zero ? "shorttime" : "overtime")">@TimeFormatter.FormatTimeSpan(day)</span>
                  <br />
              }
              <span>__________</span>
              <br />
              <span class="@(ViewBag.MonthSum < TimeSpan.Zero ? "shorttime" : "overtime")">@TimeFormatter.FormatTimeSpan(ViewBag.MonthSum)</span>
              <br />
              <span>@String.Format("{0:0}:{1}", monthAllSum.TotalHours, monthAllSum.Minutes)</span>
          }
      }
  </div>
  <div>
    <h3>Daily statistics</h3>
    @{
      if (ViewBag.DayStatistics != null)
      {
        <span class="@(ViewBag.DayStatistics < TimeSpan.Zero ? "shorttime" : "overtime")">@TimeFormatter.FormatTimeSpan(ViewBag.DayStatistics)</span>
      }
    }
  </div>
</div>